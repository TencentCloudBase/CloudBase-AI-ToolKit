---
name: CloudBase Document Database
description: Work with CloudBase document database across multiple platforms to query, create, update, and delete data.
---

# CloudBase Document Database Skill

This skill provides guidance on using CloudBase document database across different platforms and environments.

## Overview

CloudBase provides document-based NoSQL database services with support for multiple platforms:
- Web applications (JavaScript/TypeScript)
- Mini Programs

This skill directory is organized by platform to provide platform-specific guidance and best practices.

## Available Platform SDKs

### Web SDK
**Location:** `./web-sdk/SKILL.md`

Use the Web SDK for browser-based applications built with:
- React, Vue, Angular, or vanilla JavaScript
- TypeScript applications
- Progressive Web Apps (PWAs)

**Features:**
- Query operations (single, multiple, complex queries)
- CRUD operations (Create, Read, Update, Delete)
- Pagination (page-based and cursor-based)
- Aggregation queries
- Geolocation queries
- Real-time subscriptions (if supported)

**Quick Start:**
```javascript
import cloudbase from "@cloudbase/js-sdk";

const app = cloudbase.init({
  env: "your-env-id"
});

const db = app.database();
```
Remember that, User should sign in before actually querying the database.
See `web-sdk/SKILL.md` for comprehensive Web SDK documentation.

### Other Platforms (Coming Soon)

**Mini Program SDK** - For WeChat Mini Programs, Alipay Mini Programs, etc.

## Core Concepts

Regardless of platform, CloudBase document database shares these core concepts:

### Collections
Collections are containers for documents, similar to tables in relational databases:
```javascript
db.collection('collectionName')
```

### Documents
Documents are JSON-like objects stored in collections:
```javascript
{
  _id: "unique-id",
  field1: "value1",
  field2: 123,
  nested: {
    field: "value"
  },
}
```

It is **Recommended** to use _id as the unique identifier for documents. It is automatically generated by the document database and is guaranteed to be unique across all documents in a collection.

### Query Operations
All SDKs support rich query capabilities:
- Simple equality queries
- Comparison operators (gt, gte, lt, lte)
- Array operators (in, nin)
- Logical operators (and, or, not)
- Geolocation queries

### CRUD Operations
Standard database operations available across platforms:
- **Create**: Add new documents
- **Read**: Query and retrieve documents
- **Update**: Modify existing documents
- **Delete**: Remove documents

## Choosing the Right SDK

### Use Web SDK when:
- Building browser-based web applications
- Deploying to web hosting or CDN
- Using modern JavaScript frameworks (React, Vue, Angular)
- Need client-side data access with security rules

### Use Mini Program SDK when:
- Building WeChat Mini Programs
- Building Alipay Mini Programs
- Need platform-specific APIs and optimizations

### Use Server SDK when:
- Running server-side Node.js code
- Need administrative database access
- Bypassing client-side security rules
- Performing batch operations

## Common Patterns

### Authentication Integration
CloudBase database works seamlessly with CloudBase Authentication. It is **REQUIRED** to login before querying the database:
```javascript
// Initialize with auth
const app = cloudbase.init({
  env: "your-env-id"
});

const auth = app.auth();
const db = app.database();

// Login before database operations
await auth.signInAnonymously();

// Database operations with user context
const result = await db.collection('userPosts')
  .where({ userId: auth.currentUser.uid })
  .get();
```

### Security Rules
Define security rules to control data access:
```json
{
  "read": "auth != null && doc.userId == auth.uid",
  "write": "auth != null && doc.userId == auth.uid"
}
```

### Error Handling
Always handle database errors appropriately:
```javascript
try {
  const result = await db.collection('items').get();
  console.log(result.data);
} catch (error) {
  if (error.code === 'PERMISSION_DENIED') {
    console.error('Access denied');
  } else if (error.code === 'DATABASE_REQUEST_FAILED') {
    console.error('Request failed');
  } else {
    console.error('Unexpected error:', error);
  }
}
```

## Best Practices

### General Best Practices (All Platforms)

1. **Initialize Once**: Initialize the CloudBase SDK once at application startup
2. **Reuse Connections**: Reuse the database instance throughout your application
3. **Index Frequently Queried Fields**: Create indexes for better query performance
4. **Limit Query Results**: Use `.limit()` to prevent large data transfers
5. **Select Needed Fields**: Use `.field()` to reduce bandwidth usage
6. **Handle Errors**: Always wrap database operations in try-catch blocks
7. **Validate Data**: Validate data before writing to database
8. **Use Security Rules**: Implement proper security rules to protect data

### Performance Best Practices

1. **Pagination**: Implement pagination for large datasets
2. **Caching**: Cache frequently accessed data
3. **Batch Operations**: Use batch operations when possible
4. **Optimize Queries**: Use specific conditions to reduce scanned documents
5. **Monitor Usage**: Track database usage and optimize as needed

### Security Best Practices

1. **Never Expose Credentials**: Don't hardcode sensitive information
2. **Implement Authentication**: Require authentication for sensitive data
3. **Use Security Rules**: Define granular access control rules
4. **Validate Input**: Sanitize and validate all user input
5. **Audit Logs**: Monitor database access patterns

## Platform-Specific Documentation

Each platform has detailed documentation covering:
- SDK initialization and configuration
- Query operations and operators
- CRUD operations
- Advanced features (pagination, aggregation, geolocation)
- Platform-specific optimizations
- Code examples and patterns

**Navigate to the specific platform directory for detailed guidance:**
- `./web-sdk/` - Web browser applications
- _(More platforms coming soon)_

## Getting Started

1. **Choose Your Platform**: Identify which SDK you need based on your application type
2. **Navigate to Platform Documentation**: Go to the appropriate subdirectory (e.g., `./web-sdk/`)
3. **Read the Platform SKILL.md**: Review the platform-specific skill documentation
4. **Explore Reference Materials**: Check detailed reference documents for specific topics
5. **Implement and Test**: Start building with the provided examples and patterns

## Support and Troubleshooting

Common issues and solutions:
- **Connection Errors**: Verify environment ID and network connectivity
- **Permission Denied**: Check security rules and authentication status
- **Query Performance**: Ensure appropriate indexes are created
- **Rate Limits**: Monitor and optimize request frequency

For platform-specific troubleshooting, refer to the respective platform documentation.
---

**Ready to start?** Navigate to your platform's directory (e.g., `./web-sdk/`) and read the `SKILL.md` file for detailed guidance.
